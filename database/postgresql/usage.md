## Keyword
```
user
	CREATE USER davide WITH PASSWORD 'jw8s0F4';
	drop user <username>    
    select * from pg_user;
role  
	CREATE ROLE jonathan LOGIN;
	CREATE ROLE miriam WITH LOGIN PASSWORD 'jw8s0F4' VALID UNTIL '2005-01-01';
	CREATE ROLE admin WITH CREATEDB CREATEROLE;
	CREATE ROLE name [ WITH ADMIN rolename ]


    select * from pg_roles;

database  
schema
    select * from pg_namespace
    pg_catalog
    public

relation
    schema
    name
    type
        table
        sequence
    owner
sequence  

```
## Usage 
```
# install postgresql  
su - postgres(default user)
createdb testdb
psql -U <username> -h <hostname> -p <port> -[W|w] <dbname>
-W: with password
-w: no password

\c <dbname>ï¼š connect database
\l: list databases
\dt: show tables in default schema
\d: list of relations
\d+ <table>: like DESC in MySQL
\dn: display namespaces
\ds: display sequences
\dtS+: display relations in all schema
\encoding [ENCODING]
\password [USERNAME]


\conninfo: show connection information  
\cd [DIR]: change working directory
\setenv NAME [VALUE]: set or unset environment variable
\unset NAME: unset|delete internal variable
\! [COMMAND]: execute command in shell


\x\g\x: like \G in mysql

```

## Sequence
### topic
```
'serial' pseudotype is 32 bit
'serial8' pseudotype is 64 bit
there can be gaps in the values generated by a sequence  
nextval() increment the value of sequence and is not rolled back if its transaction  
is later aborted  
currval() return the last value generated by a sequence for the current session, regardless of transaction boundries;  
"id serial" will implicitly create a "table_id_seq" for the table, drop table will remove this sequence at the same time 

lastval() point out one of the sequences in the list and which is 
updated by nextval()  
```  
### usage  
```
create sequence fruit_id_seq;
create table apple (id int4 default nextval('fruit_id_seq') not null, name text, price numeric);
INSERT INTO apple (id, name, price) VALUES (DEFAULT, 'mac-01', 20);

SELECT currval(pg_get_serial_sequence('users', 'id'));
select curral('fruit_id_seq');

insert into apple (name, price) values ('mac-02', 300) returning id; 
```


## Database
### create database
```
createdb -h localhost -p 5432 -U postgres testdb
create database <dbname> <options>
```

### connect to database
```
\c <dbname>
psql -h localhost -p 5432 -U postgress testdb
```

### drop database
```
drop database <dbname>
dropdb  -h localhost -p 5432 -U postgress testdb
```
## Schema
A schema is a named collection of tables  
A schema can also contain views, indexes, 
sequences, data types, operators and functions  
schema can not be nested

### create schema
```
create schema <name>
create table <schema>.<tbname> ()
```
### Drop schema
```
drop schema <name>  [CASCADE]: drop all contained objects
```

## User
[user-mapping between system-user and database-user](https://www.postgresql.org/docs/9.0/static/auth-username-maps.html)



## Colume Type
### Builtin datatype 
```
numeric type
    smallint
    integer
    bigint
    decimal
    numeric
    real
    double precision
    smallserial (small autoincrementing integer)
    serial
    bigserial

monetary types
    money

character type
    varchar(n)
    char(n)
    text

binary data type
    bytea

date/time types
    timestamp(default without time zone)
    timestamp with time zone
    date 
    time without time zone
    time with time zone
    interal 

boolean type
    boolean



enumerated type(self defined type)
    CREATE TYPE week AS ENUM ('Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun');
    
geometric type
    point
    line
    lseg
    box
    path
    polygon
    circle

network address type
    cidr
    inet
    macaddr

text search type
    tsvector
    tsquery

uuid type
    uuid
    
xml type
    xml
    
json type
    json (array_to_json(), row_to_json())

array type
    CREATE TABLE monthly_savings (
       name text,
       saving_per_quarter integer ARRAY[4],
       scheme text[][]
       );
        
    INSERT INTO monthly_savings
    VALUES ('Manisha',
    '{20000, 14600, 23500, 13250}',
    '{{"FD", "MF"}, {"FD", "Property"}}');

composite type
    CREATE TYPE inventory_item AS (
       name text,
       supplier_id integer,
       price numeric
       );
    CREATE TABLE on_hand (
    item inventory_item,
    count integer
    );
    INSERT INTO on_hand VALUES (ROW('fuzzy dice', 42, 1.99), 1000);
    SELECT (item).name FROM on_hand WHERE (item).price > 9.99;
    SELECT (on_hand.item).name FROM on_hand WHERE (on_hand.item).price > 9.99;

range type
    int4range
    int8range
    numrange
    tsrange
    tstzrange
    daterange

object identifier types
    oid
    regproc (function name)
    regprocedure (function with argument types)
    regoper (operator name)
    regoperator(operator with argument types)
    regclass(relation name)
    regtype(data type name)
    regconfig(text search configuration)
    regdictionary(text search dictionary)
    
pseudo type(used to declare a function argument or result type)
    any
    anyelement
    anyarray
    anyenum
    anyrange
    cstring
    internal
    language_handler
    fdw_handler
    record
    trigger
    void
```
object identifier are used internally by postgresql as primary key for
various system tables cant used as column data type

